<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parallel Approximations · LazySets.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/juliareach.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="LazySets.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">LazySets.jl</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../getting_started/">Getting Started</a></li><li><a class="tocitem" href="../convex_sets/">Introduction to Convex Sets</a></li><li><a class="tocitem" href="../polyhedral_approximations/">Polyhedral Approximations</a></li><li><a class="tocitem" href="../decompose_example/">Decomposing an Affine Map</a></li><li><a class="tocitem" href="../fast_2d_LPs/">Fast 2D LPs</a></li><li><a class="tocitem" href="../iterative_refinement/">Iterative Refinement</a></li><li><a class="tocitem" href="../interval_hulls/">Interval Hulls</a></li><li><a class="tocitem" href="../convex_hulls/">Convex Hulls</a></li><li><a class="tocitem" href="../set_operations/">Operations on Sets</a></li><li><a class="tocitem" href="../reach_zonotopes/">A Reachability Algorithm</a></li><li><a class="tocitem" href="../reach_zonotopes_hybrid/">A Hybrid Reachability Algorithm</a></li><li><a class="tocitem" href="../concrete_polyhedra/">Concrete Polyhedra</a></li><li class="is-active"><a class="tocitem" href>Parallel Approximations</a><ul class="internal"><li><a class="tocitem" href="#Parallel-interval-hulls"><span>Parallel interval hulls</span></a></li></ul></li><li><a class="tocitem" href="../lazy_intersections/">Lazy Intersections</a></li></ul></li><li><span class="tocitem">Library</span><ul><li><a class="tocitem" href="../../lib/interfaces/">Interfaces</a></li><li><input class="collapse-toggle" id="menuitem-3-2" type="checkbox"/><label class="tocitem" for="menuitem-3-2"><span class="docs-label">Sets</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/sets/Ball1/">Ball1</a></li><li><a class="tocitem" href="../../lib/sets/Ball2/">Ball2</a></li><li><a class="tocitem" href="../../lib/sets/BallInf/">BallInf</a></li><li><a class="tocitem" href="../../lib/sets/Ballp/">Ballp</a></li><li><a class="tocitem" href="../../lib/sets/Ellipsoid/">Ellipsoid</a></li><li><a class="tocitem" href="../../lib/sets/EmptySet/">EmptySet</a></li><li><a class="tocitem" href="../../lib/sets/HalfSpace/">HalfSpace</a></li><li><a class="tocitem" href="../../lib/sets/HPolygon/">HPolygon</a></li><li><a class="tocitem" href="../../lib/sets/HPolygonOpt/">HPolygonOpt</a></li><li><a class="tocitem" href="../../lib/sets/HPolyhedron/">HPolyhedron</a></li><li><a class="tocitem" href="../../lib/sets/HPolytope/">HPolytope</a></li><li><a class="tocitem" href="../../lib/sets/Hyperplane/">Hyperplane</a></li><li><a class="tocitem" href="../../lib/sets/Hyperrectangle/">Hyperrectangle</a></li><li><a class="tocitem" href="../../lib/sets/Interval/">Interval</a></li><li><a class="tocitem" href="../../lib/sets/Line2D/">Line2D</a></li><li><a class="tocitem" href="../../lib/sets/Line/">Line</a></li><li><a class="tocitem" href="../../lib/sets/LineSegment/">LineSegment</a></li><li><a class="tocitem" href="../../lib/sets/PolynomialZonotope/">PolynomialZonotope</a></li><li><a class="tocitem" href="../../lib/sets/Singleton/">Singleton</a></li><li><a class="tocitem" href="../../lib/sets/Universe/">Universe</a></li><li><a class="tocitem" href="../../lib/sets/VPolygon/">VPolygon</a></li><li><a class="tocitem" href="../../lib/sets/VPolytope/">VPolytope</a></li><li><a class="tocitem" href="../../lib/sets/ZeroSet/">ZeroSet</a></li><li><a class="tocitem" href="../../lib/sets/Zonotope/">Zonotope</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-3" type="checkbox"/><label class="tocitem" for="menuitem-3-3"><span class="docs-label">Lazy Operations</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../lib/lazy_operations/AffineMap/">AffineMap</a></li><li><a class="tocitem" href="../../lib/lazy_operations/Bloating/">Bloating</a></li><li><a class="tocitem" href="../../lib/lazy_operations/CartesianProduct/">CartesianProduct</a></li><li><a class="tocitem" href="../../lib/lazy_operations/Complement/">Complement</a></li><li><a class="tocitem" href="../../lib/lazy_operations/ConvexHull/">ConvexHull</a></li><li><a class="tocitem" href="../../lib/lazy_operations/ExponentialMap/">ExponentialMap</a></li><li><a class="tocitem" href="../../lib/lazy_operations/Intersection/">Intersection</a></li><li><a class="tocitem" href="../../lib/lazy_operations/LinearMap/">LinearMap</a></li><li><a class="tocitem" href="../../lib/lazy_operations/MinkowskiSum/">MinkowskiSum</a></li><li><a class="tocitem" href="../../lib/lazy_operations/Rectification/">Rectification</a></li><li><a class="tocitem" href="../../lib/lazy_operations/ResetMap/">ResetMap</a></li><li><a class="tocitem" href="../../lib/lazy_operations/SymmetricIntervalHull/">SymmetricIntervalHull</a></li><li><a class="tocitem" href="../../lib/lazy_operations/Translation/">Translation</a></li><li><a class="tocitem" href="../../lib/lazy_operations/UnionSet/">UnionSet</a></li></ul></li><li><a class="tocitem" href="../../lib/binary_functions/">Concrete Operations</a></li><li><a class="tocitem" href="../../lib/conversion/">Conversions between set representations</a></li><li><a class="tocitem" href="../../lib/comparisons/">Comparisons</a></li><li><a class="tocitem" href="../../lib/approximations/">Approximations</a></li><li><a class="tocitem" href="../../lib/utils/">Utility Functions</a></li><li><a class="tocitem" href="../../lib/parallel/">Parallel</a></li></ul></li><li><a class="tocitem" href="../../about/">About</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Parallel Approximations</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parallel Approximations</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaReach/LazySets.jl/blob/master/docs/src/man/parallel_approximations.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Parallel-Approximations"><a class="docs-heading-anchor" href="#Parallel-Approximations">Parallel Approximations</a><a id="Parallel-Approximations-1"></a><a class="docs-heading-anchor-permalink" href="#Parallel-Approximations" title="Permalink"></a></h1><p>A subset of the approximation algorithms are implemented in parallel in the  <code>LazySets.Parallel</code> module. In order to use parallel versions of the algorithms, you can write:</p><pre><code class="language-julia">using LazySets
import LazySets.Parallel

# call a method implemented in parallel, for example:
S = Ball2(ones(100), 1.0)
Parallel.box_approximation(S)</code></pre><pre class="documenter-example-output">Hyperrectangle{Float64,Array{Float64,1},Array{Float64,1}}([1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  …  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0  …  1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0])</pre><p>Note that after importing or using <code>LazySets.Parallel</code>, the version of the function used must be fully qualified, eg. <code>LazySets.Approximations.box_approximation</code> for the sequential version or <code>LazySets.Parallel.box_approximation</code> for the parallel version.</p><p>The parallelization strategy that is available uses processes. To set the number of processes <code>N</code>, use the flag <code>-p N</code> at julia startup. For example, do</p><pre><code class="language-julia">$ julia -p 4</code></pre><p>to launch <code>4</code> additional local worker julia processes. Use the keyword <code>auto</code>, as in</p><pre><code class="language-julia">$ julia -p auto</code></pre><p>to launch as many workers as the number of local CPU cores.</p><ul><li><a href="#Parallel-Approximations">Parallel Approximations</a></li><ul><li><a href="#Parallel-interval-hulls">Parallel interval hulls</a></li></ul></ul><h2 id="Parallel-interval-hulls"><a class="docs-heading-anchor" href="#Parallel-interval-hulls">Parallel interval hulls</a><a id="Parallel-interval-hulls-1"></a><a class="docs-heading-anchor-permalink" href="#Parallel-interval-hulls" title="Permalink"></a></h2><p>As an illustration of the symmetric interval hull approximation of a nested lazy set computed in parallel, consider the following calculation. It arises in the discretization of set-based ODEs, and is defined below for an artificial example of a tridiagonal matrix of order <code>n</code>, where <code>n</code> is a positive integer.</p><pre><code class="language-julia">using LazySets, Expokit
using SparseArrays, LinearAlgebra

# define an nxn tridiagonal matrix
A(n) = sparse(diagm(0 =&gt; fill(0.05, n), -1 =&gt; fill(-1, n-1), 1 =&gt; fill(-1, n-1)))

# step size and initial set
δ = 0.1
X0(n) = Ball2(ones(n), 0.1)

# input coefficients matrix (nx2 matrix with coefficients from -1 to 1)
b(n) = vcat(range(-1, stop=1, length=n))
B(n) = [b(n) b(n)] 
U = BallInf(zeros(2), 1.2)

# lazy matrix exponential
eAδ(n) = SparseMatrixExp(A(n) * δ)

# set that we want to overapproximate with an interval hull
Y(n) = ConvexHull(eAδ(n) * X0(n) ⊕ (δ * B(n) * U), X0(n))</code></pre><p>The set <code>Y(n)</code> is parametric in the system&#39;s dimension <code>n</code>, to facilitate benchmarking. We will explore the computational cost as the dimension <code>n</code> increases, and compare the sequential algorithm with the parallel algorithm.</p><p>Given the lazy set <code>Y(n)</code>, we want to calculate the symmetric interval hull, which corresponds to finding the smallest <code>n</code>-dimensional hyperrectangle that contains the set <code>Y(n)</code> and is symmetric with respect to the origin. Notice that this operation is inherently parallel, since one can evaluate the support function of <code>Y</code> independently in each dimension from <code>1</code> to <code>n</code>.</p><p>The sequential algorithm returns the following execution times. We use the <code>@btime</code> macro from the <code>BenchmarkTools</code> package to have a more accurate timing than <code>@time</code>; the <code>$n</code> argument is used for interpolation of the arguments (if you are not behchmarking, pass <code>n</code> to <code>symmetric_interval_hull</code>, as usual).</p><pre><code class="language-julia">using BenchmarkTools

for n in [50, 100, 500, 1000]
    @btime res = Approximations.symmetric_interval_hull(Y($n));
end

  59.103 ms (11554 allocations: 25.89 MiB)
  129.453 ms (23118 allocations: 54.16 MiB)
  1.943 s (115530 allocations: 381.26 MiB)
  10.017 s (232506 allocations: 1.01 GiB)</code></pre><p>For the parallel benchmark, we start Julia with 4 processes with the command <code>$ julia -p 4</code> and call <code>LazySets.Parallel.symmetric_interval_hull(Y(n))</code>. </p><pre><code class="language-julia">import LazySets.Parallel

for n in [50, 100, 500, 1000]
    @btime LazySets.Parallel.symmetric_interval_hull($Y($n));
end

  6.846 ms (2550 allocations: 160.59 KiB)
  13.544 ms (3528 allocations: 271.94 KiB)
  387.556 ms (11155 allocations: 2.51 MiB)
  2.638 s (22156 allocations: 8.77 MiB)</code></pre><p>In the following table we summarize the speedup.</p><table><tr><th style="text-align: right">n</th><th style="text-align: right">Sequential (s)</th><th style="text-align: right">Parallel <code>p=4</code> (s)</th><th style="text-align: right">Speedup</th></tr><tr><td style="text-align: right">50</td><td style="text-align: right">0.059</td><td style="text-align: right">0.007</td><td style="text-align: right">8.42</td></tr><tr><td style="text-align: right">100</td><td style="text-align: right">0.129</td><td style="text-align: right">0.013</td><td style="text-align: right">9.92</td></tr><tr><td style="text-align: right">500</td><td style="text-align: right">1.94</td><td style="text-align: right">0.387</td><td style="text-align: right">4.96</td></tr><tr><td style="text-align: right">1000</td><td style="text-align: right">10.0</td><td style="text-align: right">2.64</td><td style="text-align: right">3.79</td></tr></table><p>The results in this section were obtained with a standard MacBook Pro laptop with the following specifications:</p><pre><code class="language-julia">julia&gt; versioninfo()
Julia Version 1.0.2
Commit d789231e99 (2018-11-08 20:11 UTC)
Platform Info:
  OS: macOS (x86_64-apple-darwin14.5.0)
  CPU: Intel(R) Core(TM) i7-4770HQ CPU @ 2.20GHz
  WORD_SIZE: 64
  LIBM: libopenlibm
  LLVM: libLLVM-6.0.0 (ORCJIT, haswell)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../concrete_polyhedra/">« Concrete Polyhedra</a><a class="docs-footer-nextpage" href="../lazy_intersections/">Lazy Intersections »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 21 July 2020 01:32">Tuesday 21 July 2020</span>. Using Julia version 1.4.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
